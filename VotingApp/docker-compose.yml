services:
  va_api:
    build:
      context: ./api
      dockerfile: Dockerfile
    volumes:
      - va_data:/duckdb
    environment:
      BB_API_URL: http://10.26.26.3:8001
      VOTER_SK_DECRYPTION_KEY: Al43dQKlM/aAjb5zBNYXBQ== # Generated by running "os.urandom(16)" and base64 encoding result.
      DUCKDB_PATH: /duckdb/voter-keys.duckdb
    ports:
      - "8003:8000"

  # React frontend
  va_web:
    build:
      context: ./web
      dockerfile: Dockerfile
    environment:
      VITE_API_VOTINGAPP: http://va_api:8000
    depends_on:
      - va_api
    ports:
      - "5173:80"

volumes:
  va_data:
